<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Water Department Issues</title>
<style>
  body { 
    font-family: Arial, sans-serif; 
    margin:0; padding:0; 
    background:#f4f4f4; 
    line-height:1.6; 
  }

  /* Top Bar */
  .top-bar {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 15px 40px;
      background: #fff;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      top: 0;
      font-weight: bolder;
      z-index: 1000;
  }
  .top-bar .logo {
      display: flex;
      align-items: center;
      font-size: 2rem;
      font-weight: bolder;
      color: #4c6ef4;
  }
  .top-bar .logo img {
      width: 80px;    
      height: 80px;
  }

  /* Navbar */
  nav {
      display: flex;
      justify-content: center;
      background: #4c6ef4;
      padding: 10px 0;
      flex-wrap: wrap;
  }
  nav a {
      color: #fff;
      text-decoration: none;
      margin: 5px 20px;
      font-weight: bold;
      transition: color 0.3s;
  }
  nav a:hover { color: #ffdd57; }

  .container { 
    width:90%; 
    max-width:1200px; 
    margin:20px auto; 
    background:#fff; 
    padding:20px; 
    border-radius:8px; 
    box-shadow:0 0 10px rgba(0,0,0,0.1); 
  }

  header { 
    background:#4c6ef4; 
    color:#fff; 
    padding:1rem 0; 
    text-align:center; 
    border-radius:8px 8px 0 0; }

  header h1 { 
    margin:0; 
    font-size: 1.5rem;
  }

  h2 { 
    color: #4c6ef4; 
    margin-top: 20px; 
    text-align: center;
  }

  table { 
    width:100%; 
    border-collapse:collapse; 
    margin-top:20px;
   }

  th, td { 
    padding:12px; 
    text-align:left; 
    border:1px solid #ccc; 
  }

  th { 
    background: #d0d9ff;
    color: #4c6ef4; 
  }

  img { 
    max-width:100px; 
    border-radius:4px; 
  }

  .status-select { 
    width:120px; 
    border:1px solid #ddd; 
    border-radius:4px; 
    padding:5px; 
  }

  button { 
    background:#4c6ef4; 
    color:#fff; 
    border:none; 
    border-radius:4px; 
    padding:8px 12px; 
    cursor:pointer; 
    font-size:14px; 
    transition:0.3s; 
  }

  button:hover { 
    background:#218838; 
  }

  @media (max-width:768px) {
    .container {
       padding:10px; 
      }
    table, th, td { 
      font-size:14px;
      white-space:nowrap;
      color: #4c6ef4;
    }
    .status-select { width:100px; }
    button { font-size:12px; padding:6px 10px; }
    #report-table { overflow-x:auto; display:block; }
    table { min-width:600px; }
  }

  /* Footer */
  footer {
      text-align: center;
      width: 100%;
      padding: 5px 0;
      background: #4c6ef4;
      color: #fff;
      font-weight: 500;
      margin-top: 20px;
      box-shadow: 0 -4px 8px rgba(0,0,0,0.1);
  }

</style>
</head>
<body>

  <!-- Top Bar -->
  <div class="top-bar">
      <div class="logo">
          <img src="SpotFix_logo.png" alt="SpotFix Logo">
          <span>SpotFix</span>
      </div>
  </div>

  <!-- Navbar -->
  <nav>
      <a href="index.html">Admin Dashboard</a>
      <a href="waterProblem.html">Water Department</a>
      <a href="ElectricProblem.html">Electricity</a>
      <a href="ConstructionProblem.html">Construction</a>
      <a href="SanitationProblem.html">Sanitation</a>
      <a href="https://spotfix-ambition.web.app" target="_blank" rel="noopener noreferrer">Realtime Map</a>
  </nav>

  <div class="container">
    <header>
      <h1>Water Department Issues</h1>
    </header>
    <main>
      <section id="report-table">
        <h2>Existing Reports</h2>
        <table>
          <thead>
            <tr>
              <th>Issue ID</th>
              <th>Problem Description</th>
              <th>Image/Video</th>
              <th>Location</th>
              <th>Status</th>
              <th>Name</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="report-data">
          </tbody>
        </table>
      </section>
    </main>
  </div>
  <script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-database.js"></script>
  <script>
    var firebaseConfig = {
      apiKey: "AIzaSyAXY5g3pt8jo00dFu7nCI07a8PpycBigpI",
      authDomain: "spotfix-ambition.firebaseapp.com",
      databaseURL: "https://spotfix-ambition-default-rtdb.firebaseio.com",
      projectId: "spotfix-ambition",
      storageBucket: "spotfix-ambition.appspot.com",
      messagingSenderId: "377622088606",
      appId: "1:377622088606:web:2c470214d4ba20c511e48f",
      measurementId: "G-27NX8SNTWP"
    };

    firebase.initializeApp(firebaseConfig);
    var database = firebase.database();
    var reportsRef = database.ref('water'); 

    function fetchReports() {
      reportsRef.once('value', function(snapshot) {
        var reportTable = document.getElementById('report-data');
        reportTable.innerHTML = '';
        snapshot.forEach(function(childSnapshot) {
          var reportKey = childSnapshot.key;
          var reportData = childSnapshot.val();
          var newRow = reportTable.insertRow();
          newRow.insertCell(0).textContent = reportData.issue_id;
          newRow.insertCell(1).textContent = reportData.desc;
          newRow.insertCell(2).innerHTML = `<img src="${reportData.image}" alt="Report Image">`;
          newRow.insertCell(3).textContent = `${reportData.latitude}, ${reportData.longitude}`;

          var statusCell = newRow.insertCell(4);
          var statusSelect = document.createElement('select');
          statusSelect.classList.add('status-select');
          ['solved', 'unsolved'].forEach(function(option) {
            var optElem = document.createElement('option');
            optElem.value = option;
            optElem.textContent = option.charAt(0).toUpperCase() + option.slice(1);
            if(option === reportData.status) optElem.selected = true;
            statusSelect.appendChild(optElem);
          });
          statusCell.appendChild(statusSelect);

          newRow.insertCell(5).textContent = reportData.name;

          var actionsCell = newRow.insertCell(6);
          var updateButton = document.createElement('button');
          updateButton.textContent = 'Update Status';
          updateButton.addEventListener('click', function() {
            reportsRef.child(reportKey).update({status: statusSelect.value});
          });
          actionsCell.appendChild(updateButton);
        });
      });
    }

    document.addEventListener('DOMContentLoaded', fetchReports);
  </script>
</body>

<footer>
    <p>Â© SpotFix 2024, All Rights Reserved</p>
</footer>
</html>

